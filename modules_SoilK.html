<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0"><title>modules_SoilK (09/27/13)</title>

</head>

<body>
<b><font face="Arial">
</font></b>
<h3><b><font face="Arial">SoilK</font></b></h3>
<p>This module is defined in ClassSoilK and handles soil moisture
accounting throughout the
year. When snow cover is present, the input to this module is the
infiltration (snowinfil)
generated by the modules crack, frozen etc.&nbsp; From the end of
snow melt till late fall
the infiltration (infil) is generated by the modules Greencrack,
PrairieInfiltration etc.
The soil is handled as two layers. The upper layer is called the
recharge layer and
represents the top soil. Evaporation can occur from the recharge layer,
soil_moist (all
layers) or none. The surface infiltration satisfies the recharge layer
before being used
by the lower layer. The excess water from both soil layers contribute
to the ground water
flow , depressional storage and then to sub surface flow. The
depressional storage is
allowed to drain to ground water and sub surface flow.The parameters
soil_rechr_max and
soil_moist_max represents the maximum soil moisture capacity for the
two layers i.e. field
capacity. Wilt occurs when the state variables soil_rechr and
soil_moist are equal to
zero.</p><p>ClassSoilK is derived from&nbsp;ClassSoil with the addition of processes to handle wetlands. These processes&nbsp;are described in&nbsp;upcoming papers by Shook et Al..</p>
<p>There is a variation
(#1) to handle HRU runoff through a culvert.</p><p>Evaporation and subsurface runoff are handled after
infiltration. The maximum amount of
evapotranspiration over soil is calculated by the module <em>evap</em>.&nbsp;Priestley-Taylor is always used over culvert ponds and wetlands.&nbsp;</p>
<h3><a href="Modules_new.chm::/term_observation.htm">Observations</a></h3>
<ul>
<li>none</li>
</ul>
<h3><a href="Modules_new.chm::/term_variable.htm">Variables</a></h3>
<ul>
<li>Sd (mm) - depression storage. State variable.</li>
<li>gw (mm) - ground water storage. State variable.</li>
<li>soil_rechr (mm) - soil moisture content of recharge zone,
i.e., the portion of the soil profile from which water is withdrawn by
evaporation - expressed as an equivalent depth (m<sup>3</sup>/m<sup>2</sup>).
State variable.</li>
<li>soil_moist (mm) - soil moisture content of the rooting zone
of the major vegetation type on the HRU - expressed as an equivalent
depth (m<sup>3</sup>/m<sup>2</sup>). State
variable.</li>
<li>soil_ssr (mm/int) - subsurface runoff from soil_rechr and
depressional storage. </li>
<li>cum_soil_ssr (mm) - cumulative subsurface runoff from
soil_rechr.</li>
<li>soil_ssr_D (mm/d) - daily accumulation of soil_ssr.</li>
<li>rechr_ssr (mm/int) - Portion of excess soil water from a
HRU that enters subsurface reservoirs.</li>
<li>cum_rechr_ssr (mm) - Accumulation of Portion of excess from
a HRU to ssr.</li>
<li>soil_gw (mm/int) - excess from soil_moist and depressional
storage&nbsp; that enters groundwater reservoirs. </li>
<li>cum_soil_gw (mm) - cumulative portion of excess soil water
from a HRU that enters groundwater reservoirs</li><li>Sd_water_frac () - fraction of the maximum possible Sd HRU fraction that is under water.</li><li>contrib_frac () -&nbsp;Fraction of the entire HRU area contributing water.</li><li>wetlands_evap (mm/int) - Depth of water evaporating from wetlands using Priestley-Taylor.</li><li>total_evap (mm) - Control variable based on running sum of evap.</li>
<li>soil_gw_D (mm/d) - portion of excess soil water from a HRU
that enters groundwater reservoirs in a day.</li>
<li>soil_runoff (mm/int) - remainder of excess soil water.</li>
<li>cum_soil_runoff (mm) - cumulative surface runoff.</li>
<li>soil_runoff_D (mm/d) - daily accumulation of soil_runoff.</li>
<li>cum_runoff_to_Sd (mm/int) - cumulative portion of runoff to
depression storage.</li>
<li>infil_act (mm/int) - Actual amount of water infiltrating
the soil on each HRU.</li>
<li>infil_act_D (mm/d) - Daily actual amount of water
infiltrating the soil on each HRU.</li>
<li>cum_infil (mm) - cumulative potential amount of water
infiltrating the soil on each HRU. Contents of the variable "infil" are
calculated in the infiltration module used.</li>
<li>cum_infil_act (mm) - cumulative actual amount of water
infiltrating the soil on each HRU.</li>
<li>gw_flow (mm/int) - Drainage from HRU ground water reservoir.</li>
<li>gw_flow_D (mm/d) - Daily drainage from HRU ground water
reservoir.</li>
<li>cum_gw_flow (mm) - Accumulation of excess soil water from a
HRU that enters groundwater reservoirs.</li>
<li>redirected_residual (mm*km^2/int) - redirected residual
after topping up Sd and soil_rechar in
Netroute/Netroute_D/Netroute_M/Netroute_M_D. Average over the basin.</li>
<li>cum_redirected_residual (mm*km^2/int) - cumulative
redirected residual after topping up Sd and soil_rechar in
Netroute/Netroute_D/Netroute_M/Netroute_M_D. Average over the basin.</li>
</ul>
<p>&nbsp;&nbsp;&nbsp; Culvert variables only in
variation #1.
</p>
<ul>
<li>culvert_Q (m^3/s) - flow in culvert.</li>
<li>culvert_water_H (m) - depth of pond at culvert inlet. </li>
<li>culvert_water_A (m^2) - surface area of culvert pond</li>
<li>culvert_water_V (m^3) - volume of water in culvert pond</li>
<li>culvert_water_O (m^3) - volume of water overflowing road</li>
<li>culvert_evap (mm/int) - Depth of water evaporating.</li>
<li>cum_culvert (mm) - Cumulative culvert HRU flow.</li>
<li>cum_culvert_over (mm) - Cumulative culvert HRU overflow.</li>
</ul>
<h3><a href="Modules_new.chm::/term_parameter.htm">Parameters</a></h3>
<ul>
<li>basin_area (km^2) - basin area.</li>
<li>hru area (km^2) - HRU area.</li>
<li>Sdmax (mm) - Maximum depression storage.</li>
<li>Sdinit (mm) - Initial depression storage.</li>
<li>soil_rechr_max (mm) - maximum moisture content of the soil
recharge zone - expressed as an equivalent depth (mm<sup>3</sup>/mm<sup>2</sup>).&nbsp;
Must be less than or equal to soil_moist.</li>
<li>soil_rechr_init (mm) - initial moisture content of the soil
recharge zone - expressed as an equivalent depth (mm<sup>3</sup>/mm<sup>2</sup>).
Must be less than or equal to soil_moist_init.</li>
<li>soil_moist_max (mm) - maximum available water holding
capacity of rooting zone - expressed as an equivalent depth (mm<sup>3</sup>/mm<sup>2</sup>).</li>
<li>soil_moist_init (mm) - initial moisture content of rooting
zone - expressed as an equivalent depth (mm<sup>3</sup>/mm<sup>2</sup>).</li>
<li>gw_max (mm) - Maximum available water holding capacity of
ground water reservoir.</li>
<li>gw_init (mm) - Initial value of available water in ground
water reservoir.</li>
<li>rechr_ssr_K (mm/d) - recharge ssr drainage factor.</li>
<li>lower_ssr_K (mm/d) - lower column (soil_moist - rechr_mois)
ssr drainage factor.</li>
<li>soil_gw_K (mm/d) - The maximum amount of the excess soil
water for an HRU that is routed directly to the associated groundwater
reservoir each day- expressed as an equivalent depth (mm<sup>3</sup>/mm<sup>2</sup>).</li>
<li>Sd_ssr_K (mm/d) - depression storage ssr factor.</li>
<li>Sd_gw_K(mm/d) - depression storage groundwater factor.</li>
<li>gw_K (mm/d) - daily ground water drainage from gw reservoir.</li><li>Sd_water_frac_max () - Maximum fraction of the entire HRU area that can be water.</li><li>contrib_frac_init () - Fraction of the entire HRU area contributing water.</li><li>evap_threshold (mm) - Threshold evaporation necessary for setting the contribution fraction to zero.</li>
<li>soil_withdrawal () -&nbsp; HRU evaporation withdrawal
for soil type: 1= sand, 2= loam, 3= clay.&nbsp;Water availability
is used to limit evaporation as decribed below.</li>
<li>cov_type () - Vegetation cover type designation for HRU: "0
= no evaporation, 1 = bare soil or shallow crops (evaporation from the
recharge layer only), 2 = crops, grasses, shrubs and trees (evaporation
from all soil&nbsp; moisture).</li>
<li>transp_limited () - Inhibits transpiration from the soil
moisture layer when set to 1.</li>
<li>soil_ssr_runoff () - soil column excess to
interflow(ssr)/runoff (and possibly SD) interflow-0/runoff-1</li>
</ul>
<p>&nbsp;&nbsp;&nbsp; Culvert variables only in
variation #1.
</p>
<ul>
<li>channel_slope () - soil slope to culvert.</li>
<li>side_slope () - side soil slope mormal to culvert slope</li>
<li>culvert_diam (m) - culvert diameter.</li>
<li>culvert_water_Dmax (m) - maximum depth of pond at culvert
inlet</li>
<li>number_culverts () - number of culverts and efficiency
factor. Zero = no culvert</li>
</ul>
<h3><a href="Modules_new.chm::/term_input_variable.htm">Variable
Inputs</a></h3>
<ul>
<li>hru_evap (evap) (mm/int) or (mm/d).&nbsp; Programmed
for an interval or daily value. </li>
<li>infil (*) (mm/int).</li>
<li>snowinfil (*) (mm/int) or (mm/d). &nbsp;Programmed for
an interval or daily value.</li>
<li>runoff (*) (mm/int) or (mm/d).&nbsp; Programmed for an
interval or daily value. </li>
<li>meltrunoff (*) (mm/int) or (mm/d).&nbsp; Programmed for
an interval or daily value. </li>
<li>hru_actet (*) (mm/int). Programmed as a&nbsp; <em>put</em>
value.</li>
<li>hru_cum_actet (*) (mm).Programmed as a state&nbsp; <em>put</em>
value.</li>
</ul>
<h3>Notes</h3>
<p>&nbsp;&nbsp;&nbsp; Set Sdmax to zero and
soil_moist to non- zero to model HRU with no
Depression or Pond storage.</p>
<p>&nbsp;&nbsp;&nbsp; Set Sdmax to non-zero and
soil_moist to non- zero to model HRU with
Depression storage.</p>
<p>&nbsp;&nbsp;&nbsp; Set Sdmax to non-zero and
soil_moist to zero to model HRU with Pond
storage.</p>
<p>&nbsp;&nbsp;&nbsp; The significant difference
between Pond and Depression storage is
that soil_runoff to Pond storage is unlimited to its maximum capacity
whereas depression
storage is also limited to&nbsp;&nbsp;&nbsp;&nbsp;
(Sdmax-Sd)*(1-exp(-soil_runoff/Sdmax)).</p>
<p>&nbsp;&nbsp;&nbsp; The layer soil_rechr is part of
the soil_moist zone.&nbsp; It is not
a separate identity.</p>
<p>&nbsp;&nbsp;&nbsp; Evaporation from bare soil and
shallow crops only occurs from the
recharge layer. &nbsp; All other cover types&nbsp; have
evaporation/transpiration from
recharge and soil moisture layers.</p>
<p>&nbsp;&nbsp;&nbsp; <em>transp_limited</em>
is provided to limit grasses, shrubs and
trees to only the recharge layer when the vegetation limits
transpiration during drought
conditions.</p>
<p>&nbsp;&nbsp;&nbsp; <em>infil</em>, <em>snowinfil</em>
and condensation are added to the
recharge layer and then to soil_moist. The excess is next used to
satisfy groundwater. The
surplus is designated as soil_runoff. The incoming runoff and
meltrunoff are added to
soil_runoff.&nbsp; If depression storage is specified any
soil_runoff is used to fill the
depression storage to its maximum.</p>
<p>&nbsp;</p>
<h3>Soil Withdrawal Types.</h3>
<blockquote>
<p>Water availability controls evaporation withdrawal in
'smbal' and 'Soil'. Modified from Zahner(1967) by G.H.Leavesley.</p>
<p>&nbsp;&nbsp;&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1
- Sand, at pcts &lt; 0.25, limited to 0.25*pcts*avail_evap,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2 - loam, at pcts &lt; 0.5, limited to 0.5*pcts*avail_evap,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
3 - clay, at pcts &lt; 0.67 &amp;&amp; pcts &gt; 0.33,
limited to pcts*avail_evap and at pcts &lt; 0.33 limited to
0.5*pcts*avail_evap,
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4 organic, unlimted availability,</p>
<p>where pcts = (soil moist)/(soil moist max).</p>
</blockquote>
</body></html>