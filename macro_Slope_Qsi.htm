<html>

<head>
<meta name="GENERATOR" content="Microsoft FrontPage 3.0">
<title>macro_slope_Qsi (07/06/06)</title>
</head>

<body>

<h3><b><font face="Arial">Slope_Qsi.</font></b></h3>

<p>This module estimates Qsi for a slope from the measured incoming short-wave Qsi on the
level.&nbsp; The ratio of measured Qsi and the calculated clear sky direct and diffuse on
a horizontal plane is used to adjust the calculated clear sky value on the slope.</p>

<h3><a href="Modules_new.chm::/term_observation.htm">Observations</a></h3>

<ul>
  <li>Qsi (W/m^2) - incident short-wave measured on a level plane.</li>
</ul>

<h3><a href="Modules_new.chm::/term_variable.htm">Variables</a></h3>

<ul>
  <li>Short (W/m^2) - Calculated Qsi for the slope equal to Qdro + Qdfo.</li>
  <li>ShortC (W/m^2) - Qsi corrected for slope from the ratio of (measured Qsi)/Qdflat.</li>
</ul>

<h3><a href="Modules_new.chm::/term_parameter.htm">Parameters</a></h3>

<ul>
  <li>none.</li>
</ul>

<h3><a href="Modules_new.chm::/term_input_variable.htm">Variable Inputs</a></h3>

<ul>
  <li>Qdro (global) (W/m^2).</li>
  <li>Qdfo (global) (W/m^2).</li>
  <li>Qdflat&nbsp; (global)(W/m^2).</li>
</ul>

<h3><a href="Modules_new.chm::/term_observationVariable.htm">Observation Variables</a></h3>

<ul>
  <li>Qsi# (W/m^2) - Qsi corrected for slope.</li>
</ul>

<h3>Macro Code</h3>

<p>Slope_Qsi</p>

<blockquote>
  <p>declobs, Qsi#, NHRU, &quot;Created short-wave&quot;, (W/m^2)</p>
  <p>declreadobs, Qsi, NOBS, &quot;measured short-wave&quot;, (W/m^2)</p>
  <p>declgetvar, global, Qdro, (W/m^2)</p>
  <p>declgetvar, global, Qdfo, (W/m^2)</p>
  <p>declgetvar, global, Qdflat, (W/m2)</p>
  <p>declvar, Short, NHRU, &quot;short-wave on slope&quot;, (W/m^2)</p>
  <p>declvar, ShortC, NHRU, &quot;corrected short-wave on slope&quot;, (W/m^2)</p>
</blockquote>

<p>command</p>

<blockquote>
  <p>Short[hh] = Qdro[hh] + Qdfo[hh]</p>
  <p>if(Qdflat[hh] &gt; 0.01)</p>
  <p>&nbsp; ShortC[hh] = Qsi[hh]/Qdflat[hh]*Short[hh]</p>
  <p>&nbsp; Qsi#[hh] = ShortC[hh]</p>
  <p>else</p>
  <p>&nbsp; ShortC[hh] = 0</p>
  <p>&nbsp; Qsi#[hh] = 0</p>
  <p>endif</p>
</blockquote>

<p>end</p>
</body>
</html>
